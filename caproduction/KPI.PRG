CLOSE ALL
SET SAFE OFF
CLEAR
SET TALK OFF
SET EXAC ON
USE C:\DONGGUAN\CATRACK 
COPY TO E:\GLWJ\产量汇报\运营指标\ORIGIN1;
     FOR INSPE_DATE>={2006/05/27} AND INSPE_DATE<={2006/06/26} AND !('0/0'$CA_BATCH)
**** FIELDS CA_NO,CA_BATCH,GROP_NO,CAP_CODE, GRIT,WIDE,LENTH,CUT_WIDE,CUT_LENTH,YLQX,CUT_QTY,INSPE_QTY
CLOSE ALL
USE E:\GLWJ\产量汇报\运营指标\INDI0
ZAP
APPE FROM E:\GLWJ\产量汇报\运营指标\ORIGIN1
CLOSE ALL
USE E:\GLWJ\产量汇报\运营指标\INDI0
INDE ON CAP_CODE+GRIT TO E:\GLWJ\产量汇报\运营指标\TEPT
COPY TO E:\GLWJ\产量汇报\运营指标\INDI
USE E:\GLWJ\产量汇报\运营指标\INDI
REPL ALL CUT_AREA WITH CUT_WIDE*CUT_LENTH*0.001
REPL ALL USABLE WITH CUT_AREA-YLQX
REPL ALL FINISHAREA WITH WIDE*LENTH*INSPE_QTY*0.000001
REPL ALL REJECT_QTY WITH CUT_QTY-INSPE_QTY
REPL ALL REJECTAREA WITH WIDE*LENTH*REJECT_QTY*0.000001
REPL ALL WASTEAREA WITH USABLE-FINISHAREA-REJECTAREA

**************ADD DIFFERENT CONTROL NUMBERS TO DIFFERENT CAP_CODE PRODUCTS IN INDI FILE
X=111111
GO TOP
REPL CTRLNO WITH X 
DO WHILE !EOF()
STORE CAP_CODE TO CAP
STORE CAP TO CAP0
*?CAP1
SKIP
STORE CAP_CODE TO CAP
*?CAP2
IF CAP<>CAP0
X=X+1
*?X
ENDIF
REPL CTRLNO WITH X 
ENDDO
GO BOTTOM
STORE CTRLNO TO Z
*?Z
**************************************************************************

******SUM UP EVERY SUB-BRANCH ACCCORDING TO THE CONTROL NUMBERS IN INDIS FILE
USE E:\GLWJ\产量汇报\运营指标\INDI
INDE ON CAP_CODE+GRIT TO E:\GLWJ\产量汇报\运营指标\TEMP
TOTAL ON CAP_CODE+GRIT TO E:\GLWJ\产量汇报\运营指标\INDIST FIELDS USABLE, REJECTAREA
SELE B
USE E:\GLWJ\产量汇报\运营指标\INDIS
GO TOP
ZAP
Y=111111
DO WHILE Y<=Z
APPE FROM E:\GLWJ\产量汇报\运营指标\INDIST FOR CTRLNO=Y
SELE A
USE E:\GLWJ\产量汇报\运营指标\INDIST
SUM ALL USABLE TO A FOR CTRLNO=Y
SUM ALL REJECTAREA TO B FOR CTRLNO=Y
SUM ALL USABLE TO M 
SUM ALL REJECTAREA TO N
SELE B
USE E:\GLWJ\产量汇报\运营指标\INDIS
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL CUT_AREA WITH A
REPL REJECTAREA WITH B
Y=Y+1
ENDDO
************************************************************************

**********SUM UP ALL THE REJECTAREA AND REJECTRATE IN INDIS FILE
APPE BLANK
APPE BLANK
APPE BLANK

REPL CAP_CODE WITH 'SUM UP'
REPL CUT_AREA WITH M
REPL REJECTAREA WITH N
REPL REJECTRATE WITH N/M 

REPL ALL REJECTRATE WITH REJECTAREA/CUT_AREA*100 FOR CUT_AREA#0 AND CAP_CODE#' '
REPL ALL REJECTRATE WITH -11111 FOR CUT_AREA=0 AND CAP_CODE#' '

DIMENSION P(9)

*************** TO GENERATE INDIALL FILE
USE E:\GLWJ\产量汇报\运营指标\INDIALL
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI 
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************


*************** TO GENERATE INDIW FILE FOR THE WIDE BELTS 
USE E:\GLWJ\产量汇报\运营指标\INDIW
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI FOR GROUP_NO='W'
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************

*************** TO GENERATE INDIN FILE FOR THE NRROW BELTS
USE E:\GLWJ\产量汇报\运营指标\INDIN
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI FOR GROUP_NO='N'
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************

*************** TO GENERATE THE INDIE FILE FOR THE EXTRA WIDE BELTS
USE E:\GLWJ\产量汇报\运营指标\INDIE
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI FOR GROUP_NO='E'
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************

*************** TO GENERATE INDISS FILE FOR THE SMALLER BELTS
USE E:\GLWJ\产量汇报\运营指标\INDISS
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI FOR GROUP_NO='S'
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************

*************** TO GENERATE INDIR FILE FOR THE JUMBOL ROLLS
USE E:\GLWJ\产量汇报\运营指标\INDIR
ZAP
APPE FROM  E:\GLWJ\产量汇报\运营指标\INDI FOR GROUP_NO='R'
SUM ALL YLQX TO P(1)
SUM ALL USABLE TO P(2)
SUM ALL CUT_QTY TO P(3)
SUM ALL INSPE_QTY TO P(4)
SUM ALL FINISHAREA TO P(5)
SUM ALL REJECT_QTY TO P(6)
SUM ALL REJECTAREA TO P(7)
SUM ALL WASTEAREA TO P(8)
SUM ALL CUT_AREA TO P(9)

APPE BLANK
APPE BLANK
APPE BLANK
REPL CAP_CODE WITH 'SUM UP'
REPL YLQX WITH P(1)
REPL USABLE WITH P(2)
REPL CUT_QTY WITH P(3)
REPL INSPE_QTY WITH P(4)
REPL FINISHAREA WITH P(5)
REPL REJECT_QTY WITH P(6)
REPL REJECTAREA WITH P(7)
REPL WASTEAREA WITH P(8)
REPL CUT_AREA WITH P(9)
REPL 数量报废率 WITH P(6)/P(3)*100 FOR P(3)#0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH P(7)/P(2)*100 FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH P(8)/P(2)*100  FOR P(2)#0 AND CAP_CODE='SUM UP'
REPL 数量报废率 WITH 0 FOR P(3)=0 AND CAP_CODE='SUM UP'
REPL 面积报废率 WITH 0 FOR P(2)=0 AND CAP_CODE='SUM UP'
REPL WASTERATE WITH 0  FOR P(2)=0 AND CAP_CODE='SUM UP'
**********************************************

CLOSE ALL
SET SAFE ON
SET TALK ON
SET EXAC OFF
RETURN

